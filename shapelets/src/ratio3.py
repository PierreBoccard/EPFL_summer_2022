import numpy as np
import matplotlib.pyplot as plt
import matplotlib
matplotlib.use('Agg') 
import math

from lenstronomy.Cosmo.lens_cosmo import LensCosmo

c = 3*10**8
G = 6.67*10**(-11)
DL = 1114.3281635842025 * 30856775814913670
DS = 1733.1233711711227 * 30856775814913670
DLS = 1205.1078268136632 * 30856775814913670
rad = 0.0000048481368110954
masseS = 2*10**30


    
n1 = {'kwargs_lens': [{'theta_E': 2.550105385464717, 'e1': 0.17149772868318466, 'e2': -0.06842052098038287, 'center_x': 0.065, 'center_y': 0.07}, {'theta_E': 0.676208006195847, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'theta_E': 0.4931102046459382, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'theta_E': 0.20262708118940012, 'center_x': -3.8, 'center_y': -1.41}, {'gamma1': 0.017048446403095753, 'gamma2': 0.0404620020735624, 'ra_0': 0, 'dec_0': 0}], 'kwargs_source': [{'amp': 0.24174268731737553, 'R_sersic': 0.35552536460309614, 'n_sersic': 2.199945800888023, 'e1': -0.40639659742184264, 'e2': 0.002157383718905773, 'center_x': -0.4692724274577735, 'center_y': 0.5003084141820868}, {'amp': np.array([10.69071318]), 'n_max': 0, 'beta': 0.08460256049852294, 'center_x': -0.4692724274577735, 'center_y': 0.5003084141820868}], 'kwargs_lens_light': [{'amp': 0.2010951031270906, 'R_sersic': 2.89891352046625, 'n_sersic': 3.999996227619814, 'e1': 0.12691227944711014, 'e2': -0.020522648268979458, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 14.812278681662816, 'R_sersic': 0.05000008830680654, 'n_sersic': 1.98872844825199, 'e1': -0.4924532997374733, 'e2': -0.17347657047116316, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 0.4456981167816952, 'R_sersic': 0.4000288391862849, 'n_sersic': 3.9727602742548296, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'amp': 6.668203748427291, 'R_sersic': 0.11911372620623038, 'n_sersic': 0.9491080520133622, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'amp': 7.675804860481937, 'R_sersic': 0.05307147413671134, 'n_sersic': 3.988022964053057, 'center_x': -3.8, 'center_y': -1.41}], 'kwargs_ps': [], 'kwargs_special': {}, 'kwargs_extinction': []}

n2 = {'kwargs_lens': [{'theta_E': 2.6193941353334758, 'e1': 0.1828263916332838, 'e2': -0.03516938858898779, 'center_x': 0.065, 'center_y': 0.07}, {'theta_E': 0.6447106363718851, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'theta_E': 0.4685993863176534, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'theta_E': 0.17838037378274385, 'center_x': -3.8, 'center_y': -1.41}, {'gamma1': 0.02074691725204006, 'gamma2': 0.04885531426740867, 'ra_0': 0, 'dec_0': 0}], 'kwargs_source': [{'amp': 0.11995283677719755, 'R_sersic': 0.4999893917105025, 'n_sersic': 2.1998615867785634, 'e1': -0.34302185653894185, 'e2': -0.04290669717649839, 'center_x': -0.4734438494254886, 'center_y': 0.5409999550715195}, {'amp': np.array([12.49488435,  3.21031297, -3.03306302,  2.91503168, -0.72490068,
        8.95531926]), 'n_max': 2, 'beta': 0.07236753660820486, 'center_x': -0.4734438494254886, 'center_y': 0.5409999550715195}], 'kwargs_lens_light': [{'amp': 0.20531835568286944, 'R_sersic': 2.8523456610725466, 'n_sersic': 3.99997313402696, 'e1': 0.13013796049718931, 'e2': -0.017995804675158027, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 15.736880272741478, 'R_sersic': 0.05000624113653857, 'n_sersic': 1.669826131925207, 'e1': -0.4969799373179817, 'e2': -0.14868895774867535, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 0.46042783781311936, 'R_sersic': 0.4001410684411941, 'n_sersic': 3.9168113733451726, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'amp': 6.635870971925762, 'R_sersic': 0.12107654319874708, 'n_sersic': 0.8900260161625788, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'amp': 6.436627925042764, 'R_sersic': 0.05606230864446224, 'n_sersic': 3.9883584955492113, 'center_x': -3.8, 'center_y': -1.41}], 'kwargs_ps': [], 'kwargs_special': {}, 'kwargs_extinction': []}

n4 = {'kwargs_lens': [{'theta_E': 2.5592382243560072, 'e1': 0.19436170099006453, 'e2': -0.02632113549875923, 'center_x': 0.065, 'center_y': 0.07}, {'theta_E': 0.7115110669456732, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'theta_E': 0.4591631644707628, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'theta_E': 0.1874944174432517, 'center_x': -3.8, 'center_y': -1.41}, {'gamma1': 0.025787778434483596, 'gamma2': 0.05279229404383641, 'ra_0': 0, 'dec_0': 0}], 'kwargs_source': [{'amp': 0.10847400320714672, 'R_sersic': 0.49979219159275257, 'n_sersic': 2.199981856899333, 'e1': -0.3470872791675747, 'e2': -0.06184293601265633, 'center_x': -0.4712754877316309, 'center_y': 0.5839693938217181}, {'amp': np.array([11.80257396,  2.11293676, -4.80312721,  2.55357848,  0.94514113,
        7.77607178, -2.76203149,  2.95541907,  0.0136554 , -4.96639437,
        1.09765555, -1.29785138,  1.03854455, -1.88733866,  4.66150689]), 'n_max': 4, 'beta': 0.06968979436562046, 'center_x': -0.4712754877316309, 'center_y': 0.5839693938217181}], 'kwargs_lens_light': [{'amp': 0.20483438340654542, 'R_sersic': 2.861415953447338, 'n_sersic': 3.999960172495125, 'e1': 0.130937362501216, 'e2': -0.017178601486490776, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 14.32312793234361, 'R_sersic': 0.05002437117587838, 'n_sersic': 2.0396102122955893, 'e1': -0.4982589005133018, 'e2': -0.16198781139820723, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 0.4535151381091962, 'R_sersic': 0.4001397959653168, 'n_sersic': 3.945730543973895, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'amp': 6.561778914651438, 'R_sersic': 0.11847532349367855, 'n_sersic': 1.0106259106641315, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'amp': 6.1778588309317435, 'R_sersic': 0.0594364931052968, 'n_sersic': 3.991643283455902, 'center_x': -3.8, 'center_y': -1.41}], 'kwargs_ps': [], 'kwargs_special': {}, 'kwargs_extinction': []}

n6 = {'kwargs_lens': [{'theta_E': 2.5596983710087757, 'e1': 0.1963097516138434, 'e2': -0.020852021424808097, 'center_x': 0.065, 'center_y': 0.07}, {'theta_E': 0.7053164174599391, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'theta_E': 0.46965792932796846, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'theta_E': 0.18134093414132396, 'center_x': -3.8, 'center_y': -1.41}, {'gamma1': 0.026494466158570408, 'gamma2': 0.054619911336255794, 'ra_0': 0, 'dec_0': 0}], 'kwargs_source': [{'amp': 0.11534548081348929, 'R_sersic': 0.4995925211760873, 'n_sersic': 2.199796726934607, 'e1': -0.34813897781790715, 'e2': -0.06522789432294744, 'center_x': -0.4940134511632634, 'center_y': 0.5874370463732413}, {'amp': np.array([10.95564493,  5.56653224, -3.67535183,  8.22994024, -1.45648494,
        8.06772637,  0.05094575,  2.75101042,  2.4200865 , -5.27130179,
        0.11673858,  0.30633776,  2.29611897, -1.93793091,  5.62529235,
       -0.01418263,  0.36457431,  1.69852479, -1.17353042,  3.23989928,
       -3.05132103,  1.29292432,  0.89575952,  1.00758042, -1.06484412,
        3.06868501, -3.83413916,  2.94512937]), 'n_max': 6, 'beta': 0.06002985037714106, 'center_x': -0.4940134511632634, 'center_y': 0.5874370463732413}], 'kwargs_lens_light': [{'amp': 0.2048243489397562, 'R_sersic': 2.8580681941450474, 'n_sersic': 3.9999747884860337, 'e1': 0.13008415873879714, 'e2': -0.01652370414223815, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 15.823979615796707, 'R_sersic': 0.050020085779323285, 'n_sersic': 1.6523454285997126, 'e1': -0.49825216284654245, 'e2': -0.14813443506518975, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 0.46169589813513123, 'R_sersic': 0.4004885957131214, 'n_sersic': 3.911155114611633, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'amp': 6.384111768929481, 'R_sersic': 0.12382123925490907, 'n_sersic': 0.9056529331293216, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'amp': 3.0039295600187814, 'R_sersic': 0.08956161530617626, 'n_sersic': 3.99243262863116, 'center_x': -3.8, 'center_y': -1.41}], 'kwargs_ps': [], 'kwargs_special': {}, 'kwargs_extinction': []}

n8 = {'kwargs_lens': [{'theta_E': 2.5437323445550333, 'e1': 0.2002566666872577, 'e2': -0.015180970196052187, 'center_x': 0.065, 'center_y': 0.07}, {'theta_E': 0.7257360755785653, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'theta_E': 0.4643749260585226, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'theta_E': 0.18425389006658455, 'center_x': -3.8, 'center_y': -1.41}, {'gamma1': 0.028001827647007215, 'gamma2': 0.05680065502001013, 'ra_0': 0, 'dec_0': 0}], 'kwargs_source': [{'amp': 0.10819547866265597, 'R_sersic': 0.4999566111584148, 'n_sersic': 2.1994520249383274, 'e1': -0.3498003885362961, 'e2': -0.051936677864174614, 'center_x': -0.49723994647976244, 'center_y': 0.5790411505476855}, {'amp': np.array([12.09631722,  5.4087378 , -3.09426682,  7.70551275, -1.55194184,
        8.39204685, -0.16193841,  2.96337229,  2.87951223, -5.01018148,
       -0.30964532,  0.41151924,  2.55463701, -2.28084074,  4.92201903,
       -0.20454141,  0.59413235,  1.82522445, -1.18416285,  2.74725429,
       -2.22150355,  0.99716132,  1.47894566,  0.41554991,  1.15309438,
        1.2611595 , -2.79063077,  1.59636013,  0.35026901, -0.75813918,
       -0.06350351,  1.77124213, -0.82057549,  0.50886666,  0.2529885 ,
        2.28973414,  0.23305309, -1.38079827,  0.4510189 , -1.2774438 ,
        0.74106326, -1.87509678,  1.86228757,  0.86322134,  0.55725728]), 'n_max': 8, 'beta': 0.06096448889513165, 'center_x': -0.49723994647976244, 'center_y': 0.5790411505476855}], 'kwargs_lens_light': [{'amp': 0.2045766792692722, 'R_sersic': 2.862745715124016, 'n_sersic': 3.9999934617867776, 'e1': 0.12862282595170962, 'e2': -0.017240167116679264, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 15.706256014264701, 'R_sersic': 0.05000335215307413, 'n_sersic': 1.6711953935550299, 'e1': -0.499732159898579, 'e2': -0.1495198833741628, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 0.48221592522647466, 'R_sersic': 0.4000666540496681, 'n_sersic': 3.82484016848854, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'amp': 6.6893017828403485, 'R_sersic': 0.11800283487137476, 'n_sersic': 0.9717080747023441, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'amp': 2.063743643308625, 'R_sersic': 0.11202780984434128, 'n_sersic': 3.9952937265533146, 'center_x': -3.8, 'center_y': -1.41}], 'kwargs_ps': [], 'kwargs_special': {}, 'kwargs_extinction': []}

n10 = {'kwargs_lens': [{'theta_E': 2.5294327233008356, 'e1': 0.20280614603780966, 'e2': -0.010809665731246334, 'center_x': 0.065, 'center_y': 0.07}, {'theta_E': 0.7461983146970983, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'theta_E': 0.45952241916057984, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'theta_E': 0.1832460918330341, 'center_x': -3.8, 'center_y': -1.41}, {'gamma1': 0.02880058900689752, 'gamma2': 0.057753832989166524, 'ra_0': 0, 'dec_0': 0}], 'kwargs_source': [{'amp': 0.09587402096112052, 'R_sersic': 0.4998964085280318, 'n_sersic': 2.1992043050201735, 'e1': -0.3710557360594077, 'e2': -0.04209168193549199, 'center_x': -0.48349357038801605, 'center_y': 0.5539251528549286}, {'amp': np.array([14.66502566,  4.42159437, -2.66882296,  5.75966819,  0.25594367,
       10.61940736, -1.78472009,  3.32734789,  2.41357851, -2.32491323,
       -0.20814713, -1.31374973,  4.25124213, -1.49493505,  4.23690298,
       -0.174004  ,  1.54886399,  0.30899762,  1.53775356,  2.89043955,
       -0.18742512,  2.26798819,  0.48097078,  0.72592101,  1.66589604,
        1.67304559, -0.4805715 ,  0.4766769 ,  0.26439497, -1.27370698,
        0.38317501,  0.16303175,  1.27130467, -1.12441859, -0.13095791,
        0.30548845, -0.98744258, -0.47685219, -1.49266517, -0.75914827,
       -0.04257041, -0.9074351 ,  0.71525434,  0.68021676, -0.02727422,
       -0.37754818,  0.50061548,  0.13136462,  0.37501339, -0.67320622,
        1.8655499 , -1.01150107,  1.94703123, -1.17574742,  2.24362639,
        1.08790835, -0.14749432,  1.29682592, -0.69444902,  1.71892522,
       -0.75490913,  1.51432866, -1.10933889,  2.24838074, -1.2241196 ,
        2.97169363]), 'n_max': 10, 'beta': 0.05738701347923698, 'center_x': -0.48349357038801605, 'center_y': 0.5539251528549286}], 'kwargs_lens_light': [{'amp': 0.20407533641860687, 'R_sersic': 2.8738176285854142, 'n_sersic': 3.9999163950976167, 'e1': 0.12747302934505378, 'e2': -0.01994152984604358, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 14.343800940214708, 'R_sersic': 0.050022633464457913, 'n_sersic': 2.0149104432691436, 'e1': -0.49997737784271773, 'e2': -0.15946571192021666, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 0.45158576781854276, 'R_sersic': 0.40018046292481074, 'n_sersic': 3.947112934771058, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'amp': 6.653318527062838, 'R_sersic': 0.11902503253383367, 'n_sersic': 0.9547064843695745, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'amp': 0.9152081173511395, 'R_sersic': 0.1843387289507254, 'n_sersic': 3.9975925456323766, 'center_x': -3.8, 'center_y': -1.41}], 'kwargs_ps': [], 'kwargs_special': {}, 'kwargs_extinction': []}

n12 = {'kwargs_lens': [{'theta_E': 2.5177476414751805, 'e1': 0.20276507551308467, 'e2': -0.020243669719584304, 'center_x': 0.065, 'center_y': 0.07}, {'theta_E': 0.7428833012787874, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'theta_E': 0.46847103912498683, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'theta_E': 0.19281378109197195, 'center_x': -3.8, 'center_y': -1.41}, {'gamma1': 0.02962333800050051, 'gamma2': 0.05570426663589113, 'ra_0': 0, 'dec_0': 0}], 'kwargs_source': [{'amp': 0.09127304758370346, 'R_sersic': 0.49996032269382856, 'n_sersic': 2.187790424300342, 'e1': -0.35665360845761324, 'e2': -0.03903689342442984, 'center_x': -0.5130372801834692, 'center_y': 0.5698828773865328}, {'amp': np.array([12.58368749,  6.44119516, -2.9165342 ,  7.93252815, -2.04364696,
        8.46965633,  1.07011039,  2.96195427,  3.70080279, -3.49647896,
       -0.34076377,  0.37564134,  3.45988065, -2.48172731,  3.84871745,
       -0.57209454,  0.15991995,  2.29314041, -0.25386908,  2.42657934,
       -0.04758578,  0.77785469,  1.64640454,  1.03326836,  0.58440095,
        1.65253051, -1.93426612,  0.9418696 ,  1.20929273, -0.06588555,
        0.3408572 ,  1.33755036,  0.5051912 , -1.01824248,  0.37803602,
       -0.09014264,  0.68632448, -1.74699004, -0.39153928, -0.69651831,
        0.95544309, -2.08193396,  1.51637142,  0.06946427,  1.11036314,
       -0.86937571, -0.22771077, -0.98530851, -0.08194368,  0.16101313,
       -0.08229814,  0.92828194,  0.80775866, -0.32384499,  1.04719046,
       -0.55793365,  0.50679919,  0.60784106,  0.41312397, -0.04075319,
        1.60837514,  0.0244208 ,  0.77508235, -0.01444854,  1.3208968 ,
        0.42892922,  0.74699719,  0.29034976,  0.88754128, -0.09737391,
        0.45123024, -0.31239021, -0.36873865,  0.56027188, -0.26169796,
        1.29696769,  0.11358465,  0.27377545,  0.54949337, -0.33540316,
        0.08929416, -0.50649104,  0.38197028, -1.47399777,  0.52051244,
       -0.86265441,  1.32339302, -1.20295567,  1.46362791, -1.82623543,
        2.30229972]), 'n_max': 12, 'beta': 0.06026064313489108, 'center_x': -0.5130372801834692, 'center_y': 0.5698828773865328}], 'kwargs_lens_light': [{'amp': 0.2031303601147316, 'R_sersic': 2.886102590160102, 'n_sersic': 3.999985501581261, 'e1': 0.12650774275784651, 'e2': -0.018181009198655923, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 15.056030535367716, 'R_sersic': 0.05000334436391823, 'n_sersic': 1.8736166514441295, 'e1': -0.49899452757509216, 'e2': -0.1874476724405929, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 0.4546556619840397, 'R_sersic': 0.40006823230557065, 'n_sersic': 3.935542287808817, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'amp': 6.614691911904998, 'R_sersic': 0.1198238832458598, 'n_sersic': 0.9412447004679906, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'amp': 1.184502835645436, 'R_sersic': 0.16006869097779033, 'n_sersic': 3.9994486117510424, 'center_x': -3.8, 'center_y': -1.41}], 'kwargs_ps': [], 'kwargs_special': {}, 'kwargs_extinction': []}

n14 = {'kwargs_lens': [{'theta_E': 2.5451139894693693, 'e1': 0.19904537811352682, 'e2': -0.020354979094118514, 'center_x': 0.065, 'center_y': 0.07}, {'theta_E': 0.7283158780255439, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'theta_E': 0.45861265973538806, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'theta_E': 0.18545069791285837, 'center_x': -3.8, 'center_y': -1.41}, {'gamma1': 0.028206434425376046, 'gamma2': 0.054797130321109555, 'ra_0': 0, 'dec_0': 0}], 'kwargs_source': [{'amp': 0.09503965967196734, 'R_sersic': 0.4999924497185589, 'n_sersic': 2.1979581939825796, 'e1': -0.35616916023531875, 'e2': -0.04691874410989705, 'center_x': -0.4990083632735046, 'center_y': 0.5616000484926801}, {'amp': np.array([13.54351283,  6.1096053 , -2.87733111,  9.44103689, -1.00459333,
       10.47447303,  0.71758851,  3.09950076,  3.35662646, -4.25752992,
        0.81742005, -1.03970289,  4.85842998, -1.823881  ,  6.10974544,
       -0.81892037,  1.52898171,  2.69128782,  0.37580906,  2.8928292 ,
       -2.07574866,  1.38196802,  2.39665617,  2.04288086,  1.1540599 ,
        1.65464729, -1.57838421,  1.87394085,  1.47868902, -0.53591764,
        0.86144016,  0.90130652,  1.09620726, -0.63392126,  1.00894794,
       -0.39699419,  0.59576379, -1.16548625, -1.01806606, -0.12111895,
        2.14568792, -2.36364278,  2.93601535, -1.6791762 ,  1.8342872 ,
       -1.0582407 , -0.37666055, -0.54923796,  1.68826691,  0.53481741,
        0.73752694,  0.97922035, -0.21466262, -0.12797405,  0.97345586,
        0.18818528, -0.24993603,  1.62013721, -0.31271038,  0.50369779,
        0.18050057, -0.80379625, -0.01409452, -0.21412756,  1.63560939,
        0.78995521,  0.70480032,  0.5641807 ,  0.49070425, -0.99623163,
       -0.31007225, -0.90601091, -0.55828882,  0.69397879,  0.33682946,
        0.81874464, -0.41282695,  0.04111934,  0.18720667,  0.42024178,
       -0.74712726,  0.02622937, -0.76399605,  0.31904694,  1.13288004,
        0.29287134,  1.33613573,  0.03326672,  1.21346953, -0.30365171,
        0.41673356, -0.04313828, -0.26412793, -0.17541843,  0.5674138 ,
        0.34791649,  0.47578338,  0.49939542, -0.31692335, -0.36297766,
        1.16532133,  0.06668899,  1.2832503 ,  0.28251259,  0.1551106 ,
        0.2772224 , -0.70251414,  0.7158501 , -0.39960999,  1.08208578,
       -0.9314359 ,  0.45150628, -1.11127468,  0.24854183, -0.48557381,
        1.74262779, -1.49932077,  1.25222763, -0.87080627,  3.66523989]), 'n_max': 14, 'beta': 0.05226602469567271, 'center_x': -0.4990083632735046, 'center_y': 0.5616000484926801}], 'kwargs_lens_light': [{'amp': 0.20359945329345722, 'R_sersic': 2.8769073859047674, 'n_sersic': 3.9999858236795225, 'e1': 0.12597488500918508, 'e2': -0.01539770823988647, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 14.19099231087145, 'R_sersic': 0.05000130600328635, 'n_sersic': 2.08965986040612, 'e1': -0.49996400331045493, 'e2': -0.1717262438638114, 'center_x': 0.065, 'center_y': 0.07}, {'amp': 0.46020702388201057, 'R_sersic': 0.4001152495024503, 'n_sersic': 3.91477713732736, 'e1': 0, 'e2': 0, 'center_x': -0.65, 'center_y': 1.289}, {'amp': 6.604240779476959, 'R_sersic': 0.12104351377345611, 'n_sersic': 0.9061301378375498, 'e1': 0, 'e2': 0, 'center_x': 1.849, 'center_y': 0.333}, {'amp': 0.776414727400952, 'R_sersic': 0.20306074243099984, 'n_sersic': 3.9808293520516425, 'center_x': -3.8, 'center_y': -1.41}], 'kwargs_ps': [], 'kwargs_special': {}, 'kwargs_extinction': []}

nmax = np.array([0,2,4,6,8,10,12,14])

bic0 = 28684.575944046588
bic2 = 28043.24535898489
bic4 = 27506.164928370672
bic6 = 27558.9265551743
bic8 = 27549.326542611256
bic10 = 27704.91462819432
bic12 = 27886.93328506328
bic14 = 28134.484267680713

n1G1 = list(n1.get('kwargs_lens')[0].values())[0]
n1G2 = list(n1.get('kwargs_lens')[1].values())[0]
n1G3 = list(n1.get('kwargs_lens')[2].values())[0]
n1G4 = list(n1.get('kwargs_lens')[3].values())[0]

n2G1 = list(n2.get('kwargs_lens')[0].values())[0]
n2G2 = list(n2.get('kwargs_lens')[1].values())[0]
n2G3 = list(n2.get('kwargs_lens')[2].values())[0]
n2G4 = list(n2.get('kwargs_lens')[3].values())[0]

n4G1 = list(n4.get('kwargs_lens')[0].values())[0]
n4G2 = list(n4.get('kwargs_lens')[1].values())[0]
n4G3 = list(n4.get('kwargs_lens')[2].values())[0]
n4G4 = list(n4.get('kwargs_lens')[3].values())[0]

n6G1 = list(n6.get('kwargs_lens')[0].values())[0]
n6G2 = list(n6.get('kwargs_lens')[1].values())[0]
n6G3 = list(n6.get('kwargs_lens')[2].values())[0]
n6G4 = list(n6.get('kwargs_lens')[3].values())[0]

n8G1 = list(n8.get('kwargs_lens')[0].values())[0]
n8G2 = list(n8.get('kwargs_lens')[1].values())[0]
n8G3 = list(n8.get('kwargs_lens')[2].values())[0]
n8G4 = list(n8.get('kwargs_lens')[3].values())[0]

n10G1 = list(n10.get('kwargs_lens')[0].values())[0]
n10G2 = list(n10.get('kwargs_lens')[1].values())[0]
n10G3 = list(n10.get('kwargs_lens')[2].values())[0]
n10G4 = list(n10.get('kwargs_lens')[3].values())[0]

n12G1 = list(n12.get('kwargs_lens')[0].values())[0]
n12G2 = list(n12.get('kwargs_lens')[1].values())[0]
n12G3 = list(n12.get('kwargs_lens')[2].values())[0]
n12G4 = list(n12.get('kwargs_lens')[3].values())[0]

n14G1 = list(n14.get('kwargs_lens')[0].values())[0]
n14G2 = list(n14.get('kwargs_lens')[1].values())[0]
n14G3 = list(n14.get('kwargs_lens')[2].values())[0]
n14G4 = list(n14.get('kwargs_lens')[3].values())[0]


g1 = np.array([n1G1,n2G1,n4G1,n6G1,n8G1,n10G1,n12G1,n14G1]) * rad * DL
g2 = np.array([n1G2,n2G2,n4G2,n6G2,n8G2,n10G2,n12G2,n14G2]) * rad * DL
g3 = np.array([n1G3,n2G3,n4G3,n6G3,n8G3,n10G3,n12G3,n14G3]) * rad * DL
g4 = np.array([n1G4,n2G4,n4G4,n6G4,n8G4,n10G4,n12G4,n14G4]) * rad * DL


rt = 0.68 * rad * DL

g1g2 = g1/g2
g1g3 = g1/g3
g1g4 = g1/g4

bic = np.array([bic0, bic2, bic4, bic6, bic8, bic10, bic12, bic14])


massg4 = ((g4**2)*(c**2)*DL*DS)/(4*G*DLS*masseS)

cosmo = LensCosmo(0.422,2.001)

masscosmo1 = cosmo.mass_in_theta_E(g1)/masseS
masscosmo2 = cosmo.mass_in_theta_E(g2)/masseS
masscosmo3 = cosmo.mass_in_theta_E(g3)/masseS
masscosmo4 = cosmo.mass_in_theta_E(g4)/masseS

plt.figure()
plt.scatter(nmax,g1g2,label=r'$G1/G2$',color = 'g')
plt.scatter(nmax,g1g3,label=r'$G1/G3$',color = 'r')
plt.scatter(nmax,g1g4,label=r'$G1/G4$',color = 'b')
plt.legend()
plt.grid()
plt.xlabel(r'$n_{max}$')
plt.savefig('ratio3.jpg')
plt.close()

plt.figure()
plt.scatter(nmax,g1,label=r'$G1$',color = 'g')
plt.scatter(nmax,g2,label=r'$G2$',color = 'r')
plt.scatter(nmax,g3,label=r'$G3$',color = 'b')
plt.scatter(nmax,g4,label=r'$G4$',color = 'k')
plt.legend()
plt.grid()
plt.xlabel(r'$n_{max}$')
plt.savefig('ratio3b.jpg')
plt.close()

plt.figure()
plt.scatter(nmax,bic,label=r'$bic$',color = 'g')
plt.legend()
plt.grid()
plt.xlabel(r'$n_{max}$')
plt.savefig('bic.jpg')
plt.close()

plt.figure()
plt.scatter(nmax,masscosmo1,label=r'$G1 mass$',color = 'r')
plt.scatter(nmax,masscosmo2,label=r'$G2 mass$',color = 'b')
plt.scatter(nmax,masscosmo3,label=r'$G3 mass$',color = 'g')
plt.scatter(nmax,masscosmo4,label=r'$G4 mass$',color = 'k')
plt.yscale('log')
plt.legend()
plt.grid()
plt.xlabel(r'$n_{max}$')
plt.savefig('g4masssoleil2.jpg')
plt.close()